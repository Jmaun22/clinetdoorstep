{"ast":null,"code":"var _jsxFileName = \"/Users/jesse/Documents/Portfilo/At-Your-Door-Step-/client/src/pages/Detail.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { useQuery } from '@apollo/client';\nimport Cart from '../components/Cart';\nimport { useStoreContext } from '../utils/GlobalState';\nimport { REMOVE_FROM_CART, UPDATE_CART_QUANTITY, ADD_TO_CART, UPDATE_DISHES } from '../utils/actions';\nimport { QUERY_DISHES } from '../utils/queries';\nimport { idbPromise } from '../utils/helpers';\nimport spinner from '../assets/spinner.gif';\nimport Footer from '../components/Footer';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction Detail() {\n  _s();\n\n  const [state, dispatch] = useStoreContext();\n  const {\n    id\n  } = useParams();\n  const [currentDish, setCurrentDish] = useState({});\n  const {\n    loading,\n    data\n  } = useQuery(QUERY_DISHES);\n  const {\n    dishes,\n    cart\n  } = state;\n  useEffect(() => {\n    // already in global store\n    if (dishes.length) {\n      setCurrentDish(dishes.find(dish => dish._id === id));\n    } // retrieved from server\n    else if (data) {\n      dispatch({\n        type: UPDATE_DISHES,\n        dishes: data.dishes\n      });\n      data.dishes.forEach(dish => {\n        idbPromise('dishes', 'put', dish);\n      });\n    } // get cache from idb\n    else if (!loading) {\n      idbPromise('dishes', 'get').then(indexedDishes => {\n        dispatch({\n          type: UPDATE_DISHES,\n          dishes: indexedDishes\n        });\n      });\n    }\n  }, [dishes, data, loading, dispatch, id]);\n\n  const addToCart = () => {\n    const itemInCart = cart.find(cartItem => cartItem._id === id);\n\n    if (!itemInCart) {\n      dispatch({\n        type: ADD_TO_CART,\n        dish: { ...currentDish,\n          purchaseQuantity: 1\n        }\n      });\n      idbPromise('cart', 'put', { ...currentDish,\n        purchaseQuantity: 1\n      });\n    } else {\n      dispatch({\n        type: UPDATE_CART_QUANTITY,\n        _id: id,\n        purchaseQuantity: parseInt(itemInCart.purchaseQuantity) + 1\n      });\n      idbPromise('cart', 'put', { ...itemInCart,\n        purchaseQuantity: parseInt(itemInCart.purchaseQuantity) + 1\n      });\n    }\n  };\n\n  const removeFromCart = () => {\n    dispatch({\n      type: REMOVE_FROM_CART,\n      _id: currentDish._id\n    });\n    idbPromise('cart', 'delete', { ...currentDish\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [currentDish && cart ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container my-1\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        className: \"back-to-dishes-link\",\n        to: \"/prepper\",\n        children: \"\\u2190 Back to Dishes\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        children: currentDish.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: currentDish.description\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 11\n      }, this), currentDish.ingredients ? /*#__PURE__*/_jsxDEV(\"ul\", {\n        children: currentDish.ingredients.map(ingredient => /*#__PURE__*/_jsxDEV(\"li\", {\n          children: ingredient\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 17\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n          children: \"Price:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }, this), \"$\", currentDish.price, ' ', /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: addToCart,\n          children: \"Add to Cart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          disabled: !cart.find(p => p._id === currentDish._id),\n          onClick: removeFromCart,\n          children: \"Remove from Cart\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: `/images/${currentDish.image}`,\n        alt: currentDish.name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this) : null, loading ? /*#__PURE__*/_jsxDEV(\"img\", {\n      src: spinner,\n      alt: \"loading\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 18\n    }, this) : null, /*#__PURE__*/_jsxDEV(Cart, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(Detail, \"lqNe0CjKsJOkdRzgWirGOyrgAuc=\", false, function () {\n  return [useStoreContext, useParams, useQuery];\n});\n\n_c = Detail;\nexport default Detail;\n\nvar _c;\n\n$RefreshReg$(_c, \"Detail\");","map":{"version":3,"names":["React","useEffect","useState","Link","useParams","useQuery","Cart","useStoreContext","REMOVE_FROM_CART","UPDATE_CART_QUANTITY","ADD_TO_CART","UPDATE_DISHES","QUERY_DISHES","idbPromise","spinner","Footer","Detail","state","dispatch","id","currentDish","setCurrentDish","loading","data","dishes","cart","length","find","dish","_id","type","forEach","then","indexedDishes","addToCart","itemInCart","cartItem","purchaseQuantity","parseInt","removeFromCart","name","description","ingredients","map","ingredient","price","p","image"],"sources":["/Users/jesse/Documents/Portfilo/At-Your-Door-Step-/client/src/pages/Detail.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link, useParams } from 'react-router-dom';\nimport { useQuery } from '@apollo/client';\n\nimport Cart from '../components/Cart';\nimport { useStoreContext } from '../utils/GlobalState';\nimport {\n  REMOVE_FROM_CART,\n  UPDATE_CART_QUANTITY,\n  ADD_TO_CART,\n  UPDATE_DISHES,\n} from '../utils/actions';\nimport { QUERY_DISHES } from '../utils/queries';\nimport { idbPromise } from '../utils/helpers';\nimport spinner from '../assets/spinner.gif';\nimport Footer from '../components/Footer';\n\nfunction Detail() {\n  const [state, dispatch] = useStoreContext();\n  const { id } = useParams();\n\n  const [currentDish, setCurrentDish] = useState({});\n\n  const { loading, data } = useQuery(QUERY_DISHES);\n\n  const { dishes, cart } = state;\n\n  useEffect(() => {\n    // already in global store\n    if (dishes.length) {\n      setCurrentDish(dishes.find((dish) => dish._id === id));\n    }\n    // retrieved from server\n    else if (data) {\n      dispatch({\n        type: UPDATE_DISHES,\n        dishes: data.dishes,\n      });\n\n      data.dishes.forEach((dish) => {\n        idbPromise('dishes', 'put', dish);\n      });\n    }\n    // get cache from idb\n    else if (!loading) {\n      idbPromise('dishes', 'get').then((indexedDishes) => {\n        dispatch({\n          type: UPDATE_DISHES,\n          dishes: indexedDishes,\n        });\n      });\n    }\n  }, [dishes, data, loading, dispatch, id]);\n\n  const addToCart = () => {\n    const itemInCart = cart.find((cartItem) => cartItem._id === id);\n    if (!itemInCart) {\n      dispatch({\n        type: ADD_TO_CART,\n        dish: { ...currentDish, purchaseQuantity: 1 },\n      });\n      idbPromise('cart', 'put', { ...currentDish, purchaseQuantity: 1 });\n    } else {\n      dispatch({\n        type: UPDATE_CART_QUANTITY,\n        _id: id,\n        purchaseQuantity: parseInt(itemInCart.purchaseQuantity) + 1,\n      });\n      idbPromise('cart', 'put', {\n        ...itemInCart,\n        purchaseQuantity: parseInt(itemInCart.purchaseQuantity) + 1,\n      });\n    }\n  };\n\n  const removeFromCart = () => {\n    dispatch({\n      type: REMOVE_FROM_CART,\n      _id: currentDish._id,\n    });\n\n    idbPromise('cart', 'delete', { ...currentDish });\n  };\n\n  return (\n    <>\n      {currentDish && cart ? (\n        <div className=\"container my-1\">\n          <Link className=\"back-to-dishes-link\" to=\"/prepper\">‚Üê Back to Dishes</Link>\n\n          <h2>{currentDish.name}</h2>\n\n          <p>{currentDish.description}</p>\n\n\n          {currentDish.ingredients ? (\n            <ul>\n              {currentDish.ingredients.map((ingredient) => (\n                <li>{ingredient}</li>\n              ))}\n            </ul>\n          ) : (\n            <p>Loading</p>\n          )}\n\n          <p>\n            <strong>Price:</strong>${currentDish.price}{' '}\n            <button onClick={addToCart}>Add to Cart</button>\n            <button\n              disabled={!cart.find((p) => p._id === currentDish._id)}\n              onClick={removeFromCart}\n            >\n              Remove from Cart\n            </button>\n          </p>\n\n          <img\n            src={`/images/${currentDish.image}`}\n            alt={currentDish.name}\n          />\n        </div>\n      ) : null}\n      {loading ? <img src={spinner} alt=\"loading\" /> : null}\n      <Cart />\n      <Footer />\n    </>\n  );\n}\n\nexport default Detail;\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,IAAT,EAAeC,SAAf,QAAgC,kBAAhC;AACA,SAASC,QAAT,QAAyB,gBAAzB;AAEA,OAAOC,IAAP,MAAiB,oBAAjB;AACA,SAASC,eAAT,QAAgC,sBAAhC;AACA,SACEC,gBADF,EAEEC,oBAFF,EAGEC,WAHF,EAIEC,aAJF,QAKO,kBALP;AAMA,SAASC,YAAT,QAA6B,kBAA7B;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,OAAOC,OAAP,MAAoB,uBAApB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;;;;AAEA,SAASC,MAAT,GAAkB;EAAA;;EAChB,MAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBX,eAAe,EAAzC;EACA,MAAM;IAAEY;EAAF,IAASf,SAAS,EAAxB;EAEA,MAAM,CAACgB,WAAD,EAAcC,cAAd,IAAgCnB,QAAQ,CAAC,EAAD,CAA9C;EAEA,MAAM;IAAEoB,OAAF;IAAWC;EAAX,IAAoBlB,QAAQ,CAACO,YAAD,CAAlC;EAEA,MAAM;IAAEY,MAAF;IAAUC;EAAV,IAAmBR,KAAzB;EAEAhB,SAAS,CAAC,MAAM;IACd;IACA,IAAIuB,MAAM,CAACE,MAAX,EAAmB;MACjBL,cAAc,CAACG,MAAM,CAACG,IAAP,CAAaC,IAAD,IAAUA,IAAI,CAACC,GAAL,KAAaV,EAAnC,CAAD,CAAd;IACD,CAFD,CAGA;IAHA,KAIK,IAAII,IAAJ,EAAU;MACbL,QAAQ,CAAC;QACPY,IAAI,EAAEnB,aADC;QAEPa,MAAM,EAAED,IAAI,CAACC;MAFN,CAAD,CAAR;MAKAD,IAAI,CAACC,MAAL,CAAYO,OAAZ,CAAqBH,IAAD,IAAU;QAC5Bf,UAAU,CAAC,QAAD,EAAW,KAAX,EAAkBe,IAAlB,CAAV;MACD,CAFD;IAGD,CATI,CAUL;IAVK,KAWA,IAAI,CAACN,OAAL,EAAc;MACjBT,UAAU,CAAC,QAAD,EAAW,KAAX,CAAV,CAA4BmB,IAA5B,CAAkCC,aAAD,IAAmB;QAClDf,QAAQ,CAAC;UACPY,IAAI,EAAEnB,aADC;UAEPa,MAAM,EAAES;QAFD,CAAD,CAAR;MAID,CALD;IAMD;EACF,CAzBQ,EAyBN,CAACT,MAAD,EAASD,IAAT,EAAeD,OAAf,EAAwBJ,QAAxB,EAAkCC,EAAlC,CAzBM,CAAT;;EA2BA,MAAMe,SAAS,GAAG,MAAM;IACtB,MAAMC,UAAU,GAAGV,IAAI,CAACE,IAAL,CAAWS,QAAD,IAAcA,QAAQ,CAACP,GAAT,KAAiBV,EAAzC,CAAnB;;IACA,IAAI,CAACgB,UAAL,EAAiB;MACfjB,QAAQ,CAAC;QACPY,IAAI,EAAEpB,WADC;QAEPkB,IAAI,EAAE,EAAE,GAAGR,WAAL;UAAkBiB,gBAAgB,EAAE;QAApC;MAFC,CAAD,CAAR;MAIAxB,UAAU,CAAC,MAAD,EAAS,KAAT,EAAgB,EAAE,GAAGO,WAAL;QAAkBiB,gBAAgB,EAAE;MAApC,CAAhB,CAAV;IACD,CAND,MAMO;MACLnB,QAAQ,CAAC;QACPY,IAAI,EAAErB,oBADC;QAEPoB,GAAG,EAAEV,EAFE;QAGPkB,gBAAgB,EAAEC,QAAQ,CAACH,UAAU,CAACE,gBAAZ,CAAR,GAAwC;MAHnD,CAAD,CAAR;MAKAxB,UAAU,CAAC,MAAD,EAAS,KAAT,EAAgB,EACxB,GAAGsB,UADqB;QAExBE,gBAAgB,EAAEC,QAAQ,CAACH,UAAU,CAACE,gBAAZ,CAAR,GAAwC;MAFlC,CAAhB,CAAV;IAID;EACF,CAnBD;;EAqBA,MAAME,cAAc,GAAG,MAAM;IAC3BrB,QAAQ,CAAC;MACPY,IAAI,EAAEtB,gBADC;MAEPqB,GAAG,EAAET,WAAW,CAACS;IAFV,CAAD,CAAR;IAKAhB,UAAU,CAAC,MAAD,EAAS,QAAT,EAAmB,EAAE,GAAGO;IAAL,CAAnB,CAAV;EACD,CAPD;;EASA,oBACE;IAAA,WACGA,WAAW,IAAIK,IAAf,gBACC;MAAK,SAAS,EAAC,gBAAf;MAAA,wBACE,QAAC,IAAD;QAAM,SAAS,EAAC,qBAAhB;QAAsC,EAAE,EAAC,UAAzC;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QADF,eAGE;QAAA,UAAKL,WAAW,CAACoB;MAAjB;QAAA;QAAA;QAAA;MAAA,QAHF,eAKE;QAAA,UAAIpB,WAAW,CAACqB;MAAhB;QAAA;QAAA;QAAA;MAAA,QALF,EAQGrB,WAAW,CAACsB,WAAZ,gBACC;QAAA,UACGtB,WAAW,CAACsB,WAAZ,CAAwBC,GAAxB,CAA6BC,UAAD,iBAC3B;UAAA,UAAKA;QAAL;UAAA;UAAA;UAAA;QAAA,QADD;MADH;QAAA;QAAA;QAAA;MAAA,QADD,gBAOC;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAfJ,eAkBE;QAAA,wBACE;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QADF,OAC2BxB,WAAW,CAACyB,KADvC,EAC8C,GAD9C,eAEE;UAAQ,OAAO,EAAEX,SAAjB;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAFF,eAGE;UACE,QAAQ,EAAE,CAACT,IAAI,CAACE,IAAL,CAAWmB,CAAD,IAAOA,CAAC,CAACjB,GAAF,KAAUT,WAAW,CAACS,GAAvC,CADb;UAEE,OAAO,EAAEU,cAFX;UAAA;QAAA;UAAA;UAAA;UAAA;QAAA,QAHF;MAAA;QAAA;QAAA;QAAA;MAAA,QAlBF,eA6BE;QACE,GAAG,EAAG,WAAUnB,WAAW,CAAC2B,KAAM,EADpC;QAEE,GAAG,EAAE3B,WAAW,CAACoB;MAFnB;QAAA;QAAA;QAAA;MAAA,QA7BF;IAAA;MAAA;MAAA;MAAA;IAAA,QADD,GAmCG,IApCN,EAqCGlB,OAAO,gBAAG;MAAK,GAAG,EAAER,OAAV;MAAmB,GAAG,EAAC;IAAvB;MAAA;MAAA;MAAA;IAAA,QAAH,GAAyC,IArCnD,eAsCE,QAAC,IAAD;MAAA;MAAA;MAAA;IAAA,QAtCF,eAuCE,QAAC,MAAD;MAAA;MAAA;MAAA;IAAA,QAvCF;EAAA,gBADF;AA2CD;;GA9GQE,M;UACmBT,e,EACXH,S,EAIWC,Q;;;KANnBW,M;AAgHT,eAAeA,MAAf"},"metadata":{},"sourceType":"module"}